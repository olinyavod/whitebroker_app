# Исправление проблемы с клавиатурой в MAUI

## Проблема
Когда открывается клавиатура, она перекрывает поле ввода и не понятно что вводишь.

## Решение

### 1. Android - MainActivity.cs
**Файл:** `Platforms/Android/MainActivity.cs`

**Изменения:**
- Добавлен параметр `WindowSoftInputMode = SoftInput.AdjustResize` в атрибут Activity
- Добавлен метод `OnCreate` с установкой режима изменения размера окна при появлении клавиатуры
- Импортирован namespace `Android.Views`

**Что делает:**
- `SoftInput.AdjustResize` - изменяет размер окна приложения, когда появляется клавиатура
- Это позволяет WebView автоматически прокручиваться, чтобы поле ввода было видно над клавиатурой

### 2. Android - WebViewHandler.cs
**Файл:** `Platforms/Android/WebViewHandler.cs` (новый файл)

**Что делает:**
- Настраивает WebView для корректной работы с клавиатурой
- Включает DOM Storage для localStorage и sessionStorage
- Настраивает масштабирование и скроллинг
- Устанавливает `ScrollBarStyle.InsideOverlay` для лучшего скроллинга при отображении клавиатуры

### 3. iOS - WebViewHandler.cs
**Файл:** `Platforms/iOS/WebViewHandler.cs` (новый файл)

**Что делает:**
- Настраивает WKWebView для корректной работы с клавиатурой
- Устанавливает `ContentInsetAdjustmentBehavior.Automatic` для автоматической корректировки отступов
- Включает `KeyboardDismissMode.Interactive` для интерактивного скрытия клавиатуры при скролле
- Настраивает масштабирование

### 4. MauiProgram.cs
**Файл:** `MauiProgram.cs`

**Изменения:**
- Добавлена регистрация кастомных обработчиков WebView для Android и iOS
- Добавлены условные импорты для платформозависимого кода

## Как проверить

### Android
1. Соберите и запустите приложение на Android устройстве или эмуляторе:
```bash
dotnet build -f net9.0-android
dotnet run -f net9.0-android
```

2. Откройте страницу с полем ввода
3. Коснитесь поля ввода - клавиатура должна появиться
4. WebView должен автоматически прокрутиться, чтобы поле ввода было видно над клавиатурой
5. Вы должны видеть, что вводите

### iOS
1. Соберите и запустите приложение на iOS устройстве или симуляторе:
```bash
dotnet build -f net9.0-ios
dotnet run -f net9.0-ios
```

2. Откройте страницу с полем ввода
3. Коснитесь поля ввода - клавиатура должна появиться
4. WebView должен автоматически прокрутиться, чтобы поле ввода было видно над клавиатурой
5. Вы можете скрыть клавиатуру, прокручивая WebView вниз

## Дополнительные возможности

Если проблема всё ещё возникает на некоторых устройствах, можно попробовать:

1. **Добавить JavaScript для фокусировки:**
   В MainPage.xaml.cs можно добавить код для автоматической прокрутки к полю ввода через JavaScript.

2. **Использовать другой режим:**
   Вместо `SoftInput.AdjustResize` можно попробовать `SoftInput.AdjustPan`, который не изменяет размер окна, а сдвигает его содержимое.

3. **Настроить viewport на веб-странице:**
   Убедитесь, что на веб-странице установлен правильный meta viewport:
   ```html
   <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
   ```

## Технические детали

### Android SoftInput режимы:
- `AdjustResize` - изменяет размер окна, освобождая место для клавиатуры
- `AdjustPan` - сдвигает окно вверх без изменения размера
- `AdjustNothing` - не делает ничего (по умолчанию)

### iOS ContentInsetAdjustmentBehavior:
- `Automatic` - система автоматически корректирует отступы
- `ScrollableAxes` - корректирует только для прокручиваемых осей
- `Never` - отключает автоматическую корректировку
- `Always` - всегда корректирует отступы

## Отладка

Если проблема не решается:

1. Проверьте логи приложения
2. Проверьте, что кастомный обработчик WebView регистрируется корректно
3. Попробуйте разные режимы SoftInput на Android
4. Убедитесь, что WebView имеет достаточно места для прокрутки




